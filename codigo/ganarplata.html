<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-stric.dtd"><html>	<head>		<title>Ganar Plata @ GYF</title>		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />		<style type="text/css">			body			{				font-family: Verdana;				background-color: #B9B09D;				margin: 25px;			}			#block {				background-color: white;				border: 1px solid black;				padding: 20px;			}			h1			{				text-align: center;				background-color: #4A8797;				color: white;				padding: 5px;				margin: 0px 0px 0px 0px;				border-bottom: solid 1px #284952;			}			h2			{				text-align: center;				background-color: #69BFDE;				color: white;				font-size: small;				padding: 5px;				margin: 0px 0px 20px 0px;				border-bottom: solid 1px #4A8797;			}			span			{				border-collapse: separate;				border-width: 3px;				padding: 2px 2px 2px 2px;				margin: 5px 5px 5px 5px;			}			div.query {				width: 40%;				text-align: center;				background-color: #69BFDE;				margin-left: auto;				margin-right: auto;				padding: 40px 20px 40px 20px;				border: solid 1px #4A8797;			}			div.query input {				font-size: 16px;				font-weight: bod;				text-align: center;			}			div.result {				width: 40%				text-align: center;				margin-left: auto;				margin-right: auto;				padding: 40px 20px 40px 20px;				border: solid 1px;			}			li {				color: gray;			}			.E:hover			{				border: solid darkred;				background-color: orange;			}			.A:hover			{				border: solid darkgreen;				background-color: lightgreen;			}			.B:hover			{				border: solid darkblue;				background-color: lightblue;			}			.N			{				padding: 0px 0px 0px 0px;				margin: 0px 0px 0px 0px;			}			.N:hover			{				border: solid darkgray;			}			.titCta			{				font-family: courier;				text-align: center;				width: 350px;			}			.cuentas			{				font-family: courier;				vertical-align: middle;				text-align: center;			}			.cuenta			{				width: 350px;				border: solid thin darkblue;				background-color: lightgreen;				vertical-align: middle;				padding: 0px 0px 0px 0px;				margin: 0px 0px 0px 0px;			}			.resultado			{				width: 350px;				font-weight: bold;				border: solid thin darkblue;				background-color: lightblue;				vertical-align: middle;				padding: 0px 0px 0px 0px;				margin: 0px 0px 0px 0px;			}		</style>		<script language="javascript">		<!--		function blockIE()		{			if (navigator.appName == "Microsoft Internet Explorer")			        document.write("Esta web no puede ser vista en IE.  Para utilizarla bien <a href='http://www.getfirefox.com'>bajate el Firefox</a>"); 		}		blockIE();		// -->		</script>		<script type="text/javascript">		/**			LAS FUNCIONES DEL PARSER...		**/		/*				+	*	d	~	(	)	,	$	E	A	B	N	M		Reglas:			0			d4	d19	d5				1	2	3					1	E->E+A			1	d6							A								2	E->A			2	r2	d7				r2		r2						2E		3	A->A*B			3	r4	r4				r4		r4						4A		4	A->B			4	r13	r13	d9			r13	d10	r13				8				5	B->dN			5			d4	d19	d5				11	2	3					6	B->~dN			6			d4	d19	d5					12	3					7	B->(E)			7			d4	d19	d5						13					8	N->dN			8	r5	r5				r5		r5						5B		9	N->,dM			9	r10	r10	d9			r10	d10	r10				22		10N		10	N->d			10			d14													11	M->dM			11	d6					d15										12	M->d			12	r1	d7				r1		r1						1E		13  B->d  ... 14 N->,d ... 15 B->~d			13	r3	r3				r3		r3						3A	Sgtes:			14	r14	r14	d17			r14		r14					16			E	$+)			15	r7	r7				r7		r7						7B		A	$+)*			16	r9	r9				r9		r9						9N		B	$+)*			17	r12	r12	d17			r12		r12					18	12M		N	$+)*			18	r11	r11				r11		r11						11M		M	$+)*			19			d20																	20	r15	r15	d9			r15	d10	r15				21								21	r6	r6				r6		r6						6B						22	r8	r8				r8		r8						8N					*/		var productions =		{		1:  {text:'E->E+A', left:'E', right:'E+A'},		2:  {text:'E->A'  , left:'E', right:'A'  },		3:  {text:'A->A*B', left:'A', right:'A*B'},		4:  {text:'A->B'  , left:'A', right:'B'  },		5:  {text:'B->dN' , left:'B', right:'dN' },		6:  {text:'B->~dN', left:'B', right:'~dN'},		7:  {text:'B->(E)', left:'B', right:'(E)'},		8:  {text:'N->dN' , left:'N', right:'dN' },		9:  {text:'N->.dM', left:'N', right:'.dM'},		10: {text:'N->d'  , left:'N', right:'d'  },		11: {text:'M->dM' , left:'M', right:'dM' },		12: {text:'M->d'  , left:'M', right:'d'  },		13: {text:'B->d'  , left:'B', right:'d'  },		14: {text:'N->.d' , left:'N', right:'.d' },		15: {text:'B->~d' , left:'B', right:'~d' }		}		var actions =		{		0:  {'d':'d 4', 'm':'d 19', '(':'d 5', 'E':'d 1', 'A':'d 2', 'B':'d 3'},		1:  {'+':'d 6', '$':'A'},		2:  {'+':'r 2', '*':'d 7', ')':'r 2', '$':'r 2'},		3:  {'+':'r 4', '*':'r 4', ')':'r 4', '$':'r 4'},		4:  {'+':'r 13', '*':'r 13', 'd':'d 9', ')':'r 13', '.':'d 10', '$':'r 13', 'N':'d 8'},		5:  {'d':'d 4', 'm':'d 19', '(':'d 5', 'E': 'd 11', 'A':'d 2', 'B':'d 3'},		6:  {'d':'d 4', 'm':'d 19', '(':'d 5', 'A':'d 12', 'B':'d 3'},		7:  {'d':'d 4', 'm':'d 19', '(':'d 5', 'B':'d 13'},		8:  {'+':'r 5', '*':'r 5', ')':'r 5', '$':'r 5'},		9:  {'+':'r 10', '*':'r 10', 'd':'d 9', ')':'r 10', '.':'d 10', '$':'r 10', 'N':'d 22'},		10: {'d':'d 14'},		11: {'+':'d 6', ')':'d 15'},		12: {'+':'r 1', '*':'d 7', ')':'r 1', '$':'r 1'},		13: {'+':'r 3', '*':'r 3', ')':'r 3', '$':'r 3'},		14: {'+':'r 14', '*':'r 14', 'd':'d 17', ')':'r 14', '$':'r 14', 'M':'d 16'},		15: {'+':'r 7', '*':'r 7', ')':'r 7', '$':'r 7'},		16: {'+':'r 9', '*':'r 9', ')':'r 9', '$':'r 9'},		17: {'+':'r 12', '*':'r 12', 'd':'d 17', ')':'r 12', '$':'r 12', 'M':'d 18'},		18: {'+':'r 11', '*':'r 11', ')':'r 11', '$':'r 11'},		19: {'d':'d 20'},		20: {'+':'r 15', '*':'r 15', 'd':'d 9', ')':'r 15', '.':'d 10', '$':'r 15', 'N':'d 21'},		21: {'+':'r 6', '*':'r 6', ')':'r 6', '$':'r 6'},		22: {'+':'r 8', '*':'r 8', ')':'r 8', '$':'r 8'}		}		function getAction(state, c)		{			if(typeof(state) == undefined || state === '') throw "Estado Nulo.  Esto no deberia haber pasado (o_O)";						var parsed = '';			switch(c)			{				case '+':				case '-':					parsed = '+';					break;				case '*':				case '/':					parsed = '*';					break;				case '~':					parsed = 'm';					break;				case '(':				case ')':				case '.':				case '$':				case 'E':				case 'A':				case 'B':				case 'N':				case 'M':					parsed = c;					break;				case '1':				case '2':				case '3':				case '4':				case '5':				case '6':				case '7':				case '8':				case '9':				case '0':					parsed = 'd';					break;				default:					throw "Caracter invalido.  Â¿Que hace ese '" + c + "' ahi?";			}			var str = actions[state][parsed];			if(!str || str === undefined)				throw "Caracter en posicion invalida.  Â¿Que hace ese '" + (c=='$'?'fin del texto':c) + "' ahi?";			var res = new Object();			var arr = str.split(' ');			if(arr.length > 0) res.action = arr[0];			if(arr.length > 1) res.value  = arr[1];			return res;		}				function clean(text)		{			return text.replace(/ /g,'').replace(/\t/g, '').replace(/$/g, '') + '$';		}				function stackElem(state, content)		{			var res = new Object();			res.state	= state;			res.content = content;			res.toString = function() { return this.state /*+ '<' + this.content + '>'*/; }			return res;		}				function parse(text)		{			var stack = new Array();			stack.push(stackElem(0));						while(true)			{				var c = text.substr(0,1);				var a = getAction(stack[stack.length-1].state, c);				//console.info(stack.toString() + ' | ' + text + ' | ' + a.action + ' ' + a.value);				switch(a.action)				{					case 'd':						stack.push(stackElem(a.value, c));						text = text.substr(1, text.length-1);						break;					case 'A':						return stack.pop().content;					case 'r':						var prod = productions[a.value];						var cont = '';						for(var i = 0; i < prod.right.length; i++)							cont = stack.pop().content + cont;						var ma = getAction(stack[stack.length-1].state, prod.left);						if(prod.left == 'E' || prod.left == 'A' || prod.left == 'B')						{							if( !(prod.right.length == 1 || prod.right == 'dN' || prod.right == '~dN' || prod.right == '~d'))								cont = '<span class="'								 + prod.left								 + '" op="' + prod.right								 + '" onclick="return calcularPosta(this, event);">' + cont + '</span>';							else							{								if(cont.substr(0,1) != '<' && parseFloat(cont.replace(/~/g, '-')).toString() != cont.replace(/~/g, '-'))									throw "Javascript no se banca trabajar con " + cont + ", lo transforma en " + parseFloat(cont) + ".  Perdoname, pero vas a tener que intentar con otros numeros";								cont = '<span op="' + prod.right + '">' + cont + '</span>';							}						}						stack.push(stackElem(ma.value, cont));						break;				}			}			throw "Formula Invalida!  Cuando encontramos el error, faltaba procesar: " + text;		}				/**			LA PARTE QUE HACE EL LABURO ...		**/		function calcular()		{			document.getElementById('elBoton').style.display = 'none';			setTimeout("parsear();", 10);		}		function parsear()		{			try			{				var limpio = clean(document.getElementById('laCuenta').value);				document.getElementById('laCuentaParseada').innerHTML = parse(limpio);				document.getElementById('laCuenta').style.display = 'none';				document.getElementById('elExplicado').innerHTML = '<ul><li>Clickee alguna cuenta para que el sistema la resuelva.</li><li>Cuando haya obtenido el resultado deseado puede refrescar la pagina para volver a comenzar.</li></ul>';			}			catch(e)			{				alert(e);				window.location = window.location + '?a'; // refresca la pantalla			}		}		function calcularPosta(elem, evt)		{			try			{				limpiaCuentas(elem.innerHTML.replace(/class=/g, 'bleh='));				var result					= calcularRec(elem);				if(result == elem.innerHTML) return;				elem.className				= 'N';				elem.attributes.op.value	= 'd';				elem.innerHTML				= result;			}			catch(e)			{				alert(e);			}			if(!evt) evt = window.event;			evt.stopPropagation();		}		function calcularRec(elem)		{			if(!(elem.attributes.op && elem.attributes.op.value))				return null;						var op = elem.attributes.op.value;			switch(op)			{				case 'E+A':					if(elem.childNodes[1].nodeValue == '+')						return sumar(calcularRec(elem.childNodes[0]), calcularRec(elem.childNodes[2]));					else if(elem.childNodes[1].nodeValue == '-')						return restar(calcularRec(elem.childNodes[0]), calcularRec(elem.childNodes[2]));					else						throw "Comando invalido: " + elem.childNodes[1].nodeValue;					break;				case 'A*B':					if(elem.childNodes[1].nodeValue == '*')						return multiplicar(calcularRec(elem.childNodes[0]), calcularRec(elem.childNodes[2]));					else if(elem.childNodes[1].nodeValue == '/')						return dividir(calcularRec(elem.childNodes[0]), calcularRec(elem.childNodes[2]));					else						throw "Comando invalido: " + elem.childNodes[1].nodeValue;					break;				case 'A':				case 'B':					return calcularRec(elem.firstChild);				case 'd':				case 'dN':				case '~d':				case '~dN':					return parseFloat(elem.innerHTML.replace(/~/g, '-'));				case '(E)':					return calcularRec(elem.childNodes[1]);			}					}		function sumar(x,y)		{			muestra(x, '+', y, x+y);			return x+y;		}		function restar(x,y)		{			muestra(x, '-', y, x-y);			return x-y;		}		function multiplicar(x,y)		{			muestra(x, '*', y, x*y);			return x*y;		}		function dividir(x,y)		{			muestra(x, '/', y, x/y);			return x/y;		}		function limpiaCuentas(cuenta)		{			document.getElementById('titCta').innerHTML = cuenta;			document.getElementById('cuentas').innerHTML = '';		}		function muestra(p, o, s, r)		{			document.getElementById('cuentas').innerHTML	+= '<br/><div class="cuenta">' + p 															+ ' <strong>' + o + '</strong> ' + s															+ '</div><div class="resultado">' + r															+ '</div>';		}		</script>	</head>	<body onload="blockIE();">		<div id="block">		<h1>Ganar Plata @ GYF</h1>		<h2>(by Cronopio Cronopio)</h2>		<div>			<span id="elExplicado">Ingrese una cuenta en el campo que se encuentra a continuaci&oacute;n.  Tenga en cuenta que:				<ul>					<li>Los espacios y tabuladores se ignorar&aacute;n <em>incluso si se encuentran dentro de un n&uacute;mero</em>					<li>Los n&uacute;meros negativos se representan utilizando la virgulilla: ~					<li>El separador decimal es el punto (.)					<li>No se aceptan separadores de miles					<li>Los 'unicos separadores de expresiones v&aacute;lidos son los par&eacute;ntesis, no se pueden usar corchetes ni llaves.					<li>Los operadores v&aacute;lidos son:					<ul>						<li>Suma: +						<li>Resta: -						<li>Multiplicaci&oacute;n: *						<li>Divisi&oacute;n: /						<li>Par&eacute;ntesis: ( y )					</ul>				</ul>			</span>			<div class="query">La Cuenta:				<span id="laCuentaParseada"></span>				<input id="laCuenta" type="text" value="" title="Ingrese una f&oacute;rmula, los espacios se ignorar&aacute;n" onkeypress="if(event.keyCode==13)document.getElementById('elBoton').click();"/>				<button id="elBoton" onclick="calcular(); return false" title="Comenzar el c&aacute;lculo">!</button>			</div>			<div class="query">				<div class="titCta" id="titCta"></div>				<div class="cuentas" id="cuentas"></div>			</div>			<br/>			<div id="elVideito" class="query">y por si no se entendi&oacute;, aqu&iacute; est&aacute; el manual del usuario:<br/><object width="425" height="350"> <param name="movie" value="http://www.youtube.com/v/k_iZmUhJfOs"> </param> <embed src="http://www.youtube.com/v/k_iZmUhJfOs" type="application/x-shockwave-flash" width="425" height="350"> </embed> </object></div>		</div>		<script type="text/javascript">			document.getElementById('laCuenta').focus();		</script>		</div>	</body></html>